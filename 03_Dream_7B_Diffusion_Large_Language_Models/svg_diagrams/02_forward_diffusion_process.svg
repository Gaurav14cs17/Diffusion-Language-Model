<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2200 3200" width="2200" height="3200">
  <defs>
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#9B2C2C;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#C53030;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="proofGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#FFFAF0;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#FFF5EB;stop-opacity:1" />
    </linearGradient>
    <marker id="arrowBlack" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#1a1a1a"/>
    </marker>
    <marker id="arrowRed" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#C53030"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="2200" height="3200" fill="#FAFBFC"/>
  
  <!-- Main Title Header -->
  <rect x="50" y="40" width="2100" height="120" rx="15" fill="url(#headerGrad)" stroke="#742A2A" stroke-width="3"/>
  <text x="1100" y="110" font-family="Georgia, serif" font-size="48" font-weight="bold" fill="white" text-anchor="middle">
    Forward Diffusion Process: Mathematical Details
  </text>
  <text x="1100" y="145" font-family="Arial, sans-serif" font-size="22" fill="#FED7D7" text-anchor="middle">
    The Corruption Process: q(xâ‚œ | xâ‚€)
  </text>

  <!-- Section 1: Definition -->
  <rect x="50" y="200" width="2100" height="480" rx="12" fill="#FFF5F5" stroke="#C53030" stroke-width="3"/>
  <rect x="50" y="200" width="2100" height="60" rx="12" fill="#C53030"/>
  <text x="1100" y="242" font-family="Georgia, serif" font-size="36" font-weight="bold" fill="white" text-anchor="middle">
    1. FORWARD PROCESS DEFINITION
  </text>

  <text x="100" y="310" font-family="Georgia, serif" font-size="28" font-weight="bold" fill="#000000">
    Goal: Gradually corrupt data xâ‚€ into noise (fully masked sequence)
  </text>
  
  <!-- Definition Box -->
  <rect x="100" y="340" width="980" height="300" rx="10" fill="#FFFFFF" stroke="#E53E3E" stroke-width="3"/>
  <text x="590" y="385" font-family="Georgia, serif" font-size="26" font-weight="bold" fill="#000000" text-anchor="middle">
    Markov Chain Definition
  </text>
  
  <text x="140" y="435" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#000000">
    Forward process as Markov chain:
  </text>
  <text x="140" y="480" font-family="Courier New, monospace" font-size="22" font-weight="bold" fill="#000000">
    q(xâ‚:T | xâ‚€) = âˆáµ—â¼Â¹áµ€ q(xâ‚œ | xâ‚œâ‚‹â‚)
  </text>
  
  <text x="140" y="535" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#000000">
    Each step transition:
  </text>
  <text x="140" y="580" font-family="Courier New, monospace" font-size="22" font-weight="bold" fill="#000000">
    q(xâ‚œ | xâ‚œâ‚‹â‚) = Cat(xâ‚œ ; xâ‚œâ‚‹â‚ Â· Qâ‚œ)
  </text>
  <text x="140" y="620" font-family="Arial, sans-serif" font-size="20" fill="#1a1a1a">
    where Qâ‚œ is the transition matrix at step t
  </text>

  <!-- Transition Matrix Box -->
  <rect x="1120" y="340" width="980" height="300" rx="10" fill="#FFFFFF" stroke="#E53E3E" stroke-width="3"/>
  <text x="1610" y="385" font-family="Georgia, serif" font-size="26" font-weight="bold" fill="#000000" text-anchor="middle">
    Absorbing State Transition Matrix
  </text>
  
  <text x="1160" y="435" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#000000">
    For masked diffusion with [MASK] as absorbing state:
  </text>
  
  <text x="1160" y="485" font-family="Courier New, monospace" font-size="22" font-weight="bold" fill="#000000">
    Qâ‚œ[i, j] = (1 - Î²â‚œ) Â· Î´áµ¢â±¼ + Î²â‚œ Â· Î´â±¼,[M]
  </text>
  
  <text x="1160" y="540" font-family="Arial, sans-serif" font-size="20" fill="#000000">
    â€¢ Î´áµ¢â±¼ = Kronecker delta (1 if i=j, 0 otherwise)
  </text>
  <text x="1160" y="575" font-family="Arial, sans-serif" font-size="20" fill="#000000">
    â€¢ Î²â‚œ = masking probability at step t
  </text>
  <text x="1160" y="610" font-family="Arial, sans-serif" font-size="20" fill="#1a1a1a">
    â€¢ [M] = index of [MASK] token in vocabulary
  </text>

  <!-- Section 2: Matrix Structure -->
  <rect x="50" y="720" width="2100" height="560" rx="12" fill="#FEF3C7" stroke="#D97706" stroke-width="3"/>
  <rect x="50" y="720" width="2100" height="60" rx="12" fill="#D97706"/>
  <text x="1100" y="762" font-family="Georgia, serif" font-size="36" font-weight="bold" fill="white" text-anchor="middle">
    2. TRANSITION MATRIX STRUCTURE
  </text>

  <text x="100" y="830" font-family="Georgia, serif" font-size="26" font-weight="bold" fill="#000000">
    Vocabulary size V with [MASK] as the last token (index V):
  </text>

  <!-- Matrix visualization -->
  <rect x="100" y="870" width="900" height="380" rx="10" fill="#FFFFFF" stroke="#B45309" stroke-width="3"/>
  <text x="550" y="915" font-family="Georgia, serif" font-size="26" font-weight="bold" fill="#000000" text-anchor="middle">
    Transition Matrix Qâ‚œ (V+1 Ã— V+1)
  </text>
  
  <!-- Matrix grid -->
  <rect x="200" y="950" width="700" height="280" fill="none" stroke="#1a1a1a" stroke-width="2"/>
  
  <!-- Column headers -->
  <text x="290" y="980" font-family="Courier New, monospace" font-size="18" font-weight="bold" fill="#000000" text-anchor="middle">tokâ‚</text>
  <text x="380" y="980" font-family="Courier New, monospace" font-size="18" font-weight="bold" fill="#000000" text-anchor="middle">tokâ‚‚</text>
  <text x="470" y="980" font-family="Courier New, monospace" font-size="18" font-weight="bold" fill="#000000" text-anchor="middle">...</text>
  <text x="560" y="980" font-family="Courier New, monospace" font-size="18" font-weight="bold" fill="#000000" text-anchor="middle">tokáµ¥</text>
  <text x="700" y="980" font-family="Courier New, monospace" font-size="18" font-weight="bold" fill="#C53030" text-anchor="middle">[MASK]</text>
  
  <!-- Row headers -->
  <text x="160" y="1030" font-family="Courier New, monospace" font-size="18" font-weight="bold" fill="#000000" text-anchor="middle">tokâ‚</text>
  <text x="160" y="1080" font-family="Courier New, monospace" font-size="18" font-weight="bold" fill="#000000" text-anchor="middle">tokâ‚‚</text>
  <text x="160" y="1130" font-family="Courier New, monospace" font-size="18" font-weight="bold" fill="#000000" text-anchor="middle">...</text>
  <text x="160" y="1180" font-family="Courier New, monospace" font-size="18" font-weight="bold" fill="#000000" text-anchor="middle">tokáµ¥</text>
  <text x="160" y="1220" font-family="Courier New, monospace" font-size="16" font-weight="bold" fill="#C53030" text-anchor="middle">[MASK]</text>
  
  <!-- Matrix values - diagonal -->
  <rect x="250" y="1010" width="80" height="35" fill="#C6F6D5" stroke="#276749" stroke-width="1"/>
  <text x="290" y="1035" font-family="Courier New, monospace" font-size="16" font-weight="bold" fill="#000000" text-anchor="middle">1-Î²â‚œ</text>
  
  <rect x="340" y="1060" width="80" height="35" fill="#C6F6D5" stroke="#276749" stroke-width="1"/>
  <text x="380" y="1085" font-family="Courier New, monospace" font-size="16" font-weight="bold" fill="#000000" text-anchor="middle">1-Î²â‚œ</text>
  
  <rect x="430" y="1110" width="80" height="35" fill="#EDF2F7" stroke="#4A5568" stroke-width="1"/>
  <text x="470" y="1135" font-family="Courier New, monospace" font-size="16" font-weight="bold" fill="#000000" text-anchor="middle">â‹±</text>
  
  <rect x="520" y="1160" width="80" height="35" fill="#C6F6D5" stroke="#276749" stroke-width="1"/>
  <text x="560" y="1185" font-family="Courier New, monospace" font-size="16" font-weight="bold" fill="#000000" text-anchor="middle">1-Î²â‚œ</text>
  
  <!-- Last column (MASK transition) -->
  <rect x="660" y="1010" width="80" height="35" fill="#FED7D7" stroke="#C53030" stroke-width="1"/>
  <text x="700" y="1035" font-family="Courier New, monospace" font-size="16" font-weight="bold" fill="#000000" text-anchor="middle">Î²â‚œ</text>
  
  <rect x="660" y="1060" width="80" height="35" fill="#FED7D7" stroke="#C53030" stroke-width="1"/>
  <text x="700" y="1085" font-family="Courier New, monospace" font-size="16" font-weight="bold" fill="#000000" text-anchor="middle">Î²â‚œ</text>
  
  <rect x="660" y="1110" width="80" height="35" fill="#EDF2F7" stroke="#4A5568" stroke-width="1"/>
  <text x="700" y="1135" font-family="Courier New, monospace" font-size="16" font-weight="bold" fill="#000000" text-anchor="middle">â‹®</text>
  
  <rect x="660" y="1160" width="80" height="35" fill="#FED7D7" stroke="#C53030" stroke-width="1"/>
  <text x="700" y="1185" font-family="Courier New, monospace" font-size="16" font-weight="bold" fill="#000000" text-anchor="middle">Î²â‚œ</text>
  
  <!-- MASK row (absorbing) -->
  <rect x="660" y="1200" width="80" height="35" fill="#9B2C2C" stroke="#742A2A" stroke-width="1"/>
  <text x="700" y="1225" font-family="Courier New, monospace" font-size="16" font-weight="bold" fill="white" text-anchor="middle">1</text>
  
  <!-- Zeros in off-diagonal (except mask column) -->
  <text x="335" y="1035" font-family="Courier New, monospace" font-size="14" fill="#718096" text-anchor="middle">0</text>
  <text x="425" y="1035" font-family="Courier New, monospace" font-size="14" fill="#718096" text-anchor="middle">...</text>
  <text x="515" y="1035" font-family="Courier New, monospace" font-size="14" fill="#718096" text-anchor="middle">0</text>

  <!-- Interpretation Box -->
  <rect x="1050" y="870" width="1050" height="380" rx="10" fill="#FFFFFF" stroke="#B45309" stroke-width="3"/>
  <text x="1575" y="915" font-family="Georgia, serif" font-size="26" font-weight="bold" fill="#000000" text-anchor="middle">
    Interpretation of Each Entry
  </text>
  
  <text x="1090" y="965" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#276749">
    Diagonal entries (1 - Î²â‚œ):
  </text>
  <text x="1110" y="1005" font-family="Arial, sans-serif" font-size="20" fill="#000000">
    Probability that token STAYS the same
  </text>
  
  <text x="1090" y="1055" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#C53030">
    Last column entries (Î²â‚œ):
  </text>
  <text x="1110" y="1095" font-family="Arial, sans-serif" font-size="20" fill="#000000">
    Probability that token becomes [MASK]
  </text>
  
  <text x="1090" y="1145" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#9B2C2C">
    Last row (absorbing state):
  </text>
  <text x="1110" y="1185" font-family="Arial, sans-serif" font-size="20" fill="#000000">
    Once masked, ALWAYS stays masked (probability 1)
  </text>
  
  <text x="1090" y="1235" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#2D3748">
    Row sum = 1:
  </text>
  <text x="1110" y="1225" font-family="Courier New, monospace" font-size="18" fill="#000000">
    
  </text>
  <text x="1110" y="1230" font-family="Arial, sans-serif" font-size="20" fill="#1a1a1a">
    (1 - Î²â‚œ) + Î²â‚œ = 1 (valid probability distribution)
  </text>

  <!-- Section 3: Marginal Distribution -->
  <rect x="50" y="1320" width="2100" height="620" rx="12" fill="#EBF8FF" stroke="#3182CE" stroke-width="3"/>
  <rect x="50" y="1320" width="2100" height="60" rx="12" fill="#3182CE"/>
  <text x="1100" y="1362" font-family="Georgia, serif" font-size="36" font-weight="bold" fill="white" text-anchor="middle">
    3. MARGINAL DISTRIBUTION q(xâ‚œ | xâ‚€) â€” PROOF
  </text>

  <!-- Proof Box -->
  <rect x="100" y="1410" width="2000" height="500" rx="10" fill="url(#proofGrad)" stroke="#2B6CB0" stroke-width="3"/>
  <text x="1100" y="1455" font-family="Georgia, serif" font-size="28" font-weight="bold" fill="#000000" text-anchor="middle">
    Theorem: Closed-Form Marginal Distribution
  </text>

  <text x="140" y="1510" font-family="Georgia, serif" font-size="24" font-weight="bold" fill="#1a365d">
    Statement:
  </text>
  <text x="160" y="1550" font-family="Courier New, monospace" font-size="22" font-weight="bold" fill="#000000">
    q(xâ‚œ | xâ‚€) = Cat(xâ‚œ ; xâ‚€ Â· QÌ„â‚œ)   where QÌ„â‚œ = Qâ‚ Â· Qâ‚‚ Â· ... Â· Qâ‚œ
  </text>
  
  <text x="140" y="1610" font-family="Georgia, serif" font-size="24" font-weight="bold" fill="#1a365d">
    Proof:
  </text>
  
  <text x="160" y="1655" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#000000">
    Step 1: By chain rule of probability
  </text>
  <text x="180" y="1695" font-family="Courier New, monospace" font-size="20" fill="#000000">
    q(xâ‚œ | xâ‚€) = âˆ‘_{xâ‚,...,xâ‚œâ‚‹â‚} q(xâ‚|xâ‚€) Â· q(xâ‚‚|xâ‚) Â· ... Â· q(xâ‚œ|xâ‚œâ‚‹â‚)
  </text>
  
  <text x="160" y="1750" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#000000">
    Step 2: Matrix multiplication property
  </text>
  <text x="180" y="1790" font-family="Courier New, monospace" font-size="20" fill="#000000">
    q(xâ‚œ | xâ‚€) = (xâ‚€ Â· Qâ‚) Â· Qâ‚‚ Â· ... Â· Qâ‚œ = xâ‚€ Â· (Qâ‚ Â· Qâ‚‚ Â· ... Â· Qâ‚œ) = xâ‚€ Â· QÌ„â‚œ
  </text>
  
  <text x="160" y="1845" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#000000">
    Step 3: For absorbing-state diffusion, QÌ„â‚œ simplifies to:
  </text>
  <text x="180" y="1885" font-family="Courier New, monospace" font-size="20" font-weight="bold" fill="#000000">
    QÌ„â‚œ[i, j] = Î±â‚œ Â· Î´áµ¢â±¼ + (1 - Î±â‚œ) Â· Î´â±¼,[M]   where Î±â‚œ = âˆâ‚›â‚Œâ‚áµ— (1 - Î²â‚›)
  </text>

  <!-- Section 4: Noise Schedule -->
  <rect x="50" y="1980" width="2100" height="500" rx="12" fill="#F0FFF4" stroke="#38A169" stroke-width="3"/>
  <rect x="50" y="1980" width="2100" height="60" rx="12" fill="#38A169"/>
  <text x="1100" y="2022" font-family="Georgia, serif" font-size="36" font-weight="bold" fill="white" text-anchor="middle">
    4. NOISE SCHEDULE: Î²â‚œ AND Î±â‚œ
  </text>

  <rect x="100" y="2070" width="980" height="380" rx="10" fill="#FFFFFF" stroke="#276749" stroke-width="3"/>
  <text x="590" y="2115" font-family="Georgia, serif" font-size="26" font-weight="bold" fill="#000000" text-anchor="middle">
    Definitions
  </text>
  
  <text x="140" y="2165" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#000000">
    Per-step masking rate:
  </text>
  <text x="160" y="2205" font-family="Courier New, monospace" font-size="22" font-weight="bold" fill="#000000">
    Î²â‚œ = probability of masking at step t
  </text>
  
  <text x="140" y="2260" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#000000">
    Cumulative survival probability:
  </text>
  <text x="160" y="2300" font-family="Courier New, monospace" font-size="22" font-weight="bold" fill="#000000">
    Î±â‚œ = âˆâ‚›â‚Œâ‚áµ— (1 - Î²â‚›)
  </text>
  
  <text x="140" y="2355" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#000000">
    Meaning:
  </text>
  <text x="160" y="2395" font-family="Arial, sans-serif" font-size="20" fill="#000000">
    P(xâ‚œ = xâ‚€) = Î±â‚œ (token survives unmasked)
  </text>
  <text x="160" y="2430" font-family="Arial, sans-serif" font-size="20" fill="#000000">
    P(xâ‚œ = [MASK]) = 1 - Î±â‚œ (token is masked)
  </text>

  <rect x="1120" y="2070" width="980" height="380" rx="10" fill="#FFFFFF" stroke="#276749" stroke-width="3"/>
  <text x="1610" y="2115" font-family="Georgia, serif" font-size="26" font-weight="bold" fill="#000000" text-anchor="middle">
    Common Noise Schedules
  </text>
  
  <text x="1160" y="2165" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#2B6CB0">
    Linear Schedule:
  </text>
  <text x="1180" y="2205" font-family="Courier New, monospace" font-size="20" fill="#000000">
    Î²â‚œ = Î²â‚ + (t-1)/(T-1) Â· (Î²_T - Î²â‚)
  </text>
  
  <text x="1160" y="2260" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#9B2C2C">
    Cosine Schedule (preferred):
  </text>
  <text x="1180" y="2300" font-family="Courier New, monospace" font-size="20" fill="#000000">
    Î±â‚œ = cosÂ²(Ï€Â·t/(2T) + offset)
  </text>
  <text x="1180" y="2340" font-family="Arial, sans-serif" font-size="18" fill="#1a1a1a">
    Provides smoother corruption
  </text>
  
  <text x="1160" y="2395" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#38A169">
    MDLM/Dream Schedule:
  </text>
  <text x="1180" y="2435" font-family="Courier New, monospace" font-size="20" fill="#000000">
    Î±â‚œ = 1 - t   (continuous time t âˆˆ [0,1])
  </text>

  <!-- Section 5: Complete Proof Box -->
  <rect x="50" y="2520" width="2100" height="640" rx="12" fill="#FAF5FF" stroke="#805AD5" stroke-width="3"/>
  <rect x="50" y="2520" width="2100" height="60" rx="12" fill="#805AD5"/>
  <text x="1100" y="2562" font-family="Georgia, serif" font-size="36" font-weight="bold" fill="white" text-anchor="middle">
    5. COMPLETE DERIVATION: PROBABILITY OF TOKEN STATE
  </text>

  <rect x="100" y="2610" width="2000" height="520" rx="10" fill="#FFFFFF" stroke="#6B46C1" stroke-width="3"/>
  
  <text x="140" y="2660" font-family="Georgia, serif" font-size="26" font-weight="bold" fill="#000000">
    Given: Token xâ‚€â± at position i with vocabulary index v âˆˆ {1, ..., V}
  </text>
  
  <text x="140" y="2720" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#1a365d">
    Claim: The probability distribution of xâ‚œâ± given xâ‚€â± is:
  </text>
  
  <rect x="160" y="2750" width="1900" height="100" rx="8" fill="#EDF2F7" stroke="#4A5568" stroke-width="2"/>
  <text x="1100" y="2810" font-family="Courier New, monospace" font-size="24" font-weight="bold" fill="#000000" text-anchor="middle">
    q(xâ‚œâ± = w | xâ‚€â± = v) = Î±â‚œ Â· ğŸ™[w = v] + (1 - Î±â‚œ) Â· ğŸ™[w = [MASK]]
  </text>
  
  <text x="140" y="2890" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#1a365d">
    Proof by induction:
  </text>
  
  <text x="160" y="2935" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#000000">
    Base case (t = 1):
  </text>
  <text x="180" y="2975" font-family="Courier New, monospace" font-size="18" fill="#000000">
    q(xâ‚â± = w | xâ‚€â± = v) = (1-Î²â‚)Â·ğŸ™[w=v] + Î²â‚Â·ğŸ™[w=[M]] = Î±â‚Â·ğŸ™[w=v] + (1-Î±â‚)Â·ğŸ™[w=[M]] âœ“
  </text>
  
  <text x="160" y="3025" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#000000">
    Inductive step: Assume true for t-1, prove for t:
  </text>
  <text x="180" y="3065" font-family="Courier New, monospace" font-size="18" fill="#000000">
    q(xâ‚œ|xâ‚€) = âˆ‘_{xâ‚œâ‚‹â‚} q(xâ‚œ|xâ‚œâ‚‹â‚)Â·q(xâ‚œâ‚‹â‚|xâ‚€)
  </text>
  <text x="180" y="3105" font-family="Courier New, monospace" font-size="18" fill="#000000">
    = [(1-Î²â‚œ)Â·Î±â‚œâ‚‹â‚]Â·ğŸ™[w=v] + [Î²â‚œÂ·Î±â‚œâ‚‹â‚ + 1Â·(1-Î±â‚œâ‚‹â‚)]Â·ğŸ™[w=[M]]
  </text>
  <text x="180" y="3105" font-family="Courier New, monospace" font-size="18" fill="#000000">
    
  </text>

  <!-- Footer -->
  <rect x="50" y="3110" width="2100" height="60" rx="12" fill="#2D3748"/>
  <text x="1100" y="3150" font-family="Georgia, serif" font-size="24" font-weight="bold" fill="white" text-anchor="middle">
    The forward process transforms clean data into noise through a Markov chain with closed-form marginals
  </text>
</svg>


<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2200 2400" width="2200" height="2400">
  <defs>
    <linearGradient id="diffHeader" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#00695c;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#00897b;stop-opacity:1" />
    </linearGradient>
    <filter id="shadowDiff" x="-5%" y="-5%" width="110%" height="110%">
      <feDropShadow dx="3" dy="3" stdDeviation="4" flood-opacity="0.3"/>
    </filter>
    <marker id="arrowDiff" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#00695c"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="2200" height="2400" fill="#FAFAFA"/>
  
  <!-- Title Header -->
  <rect x="50" y="40" width="2100" height="100" rx="15" fill="url(#diffHeader)" filter="url(#shadowDiff)"/>
  <text x="1100" y="105" font-family="Arial, sans-serif" font-size="48" font-weight="bold" fill="white" text-anchor="middle">
    Masked Diffusion Language Modeling
  </text>
  
  <!-- Forward Process Section -->
  <rect x="50" y="180" width="2100" height="450" rx="12" fill="#e0f2f1" stroke="#00897b" stroke-width="3" filter="url(#shadowDiff)"/>
  <text x="90" y="240" font-family="Arial, sans-serif" font-size="32" font-weight="bold" fill="#000000">
    üì• Forward Process: Adding Noise (Masking)
  </text>
  
  <!-- Formula -->
  <rect x="90" y="270" width="2020" height="100" rx="10" fill="#b2dfdb" stroke="#00695c" stroke-width="2"/>
  <text x="130" y="315" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#000000">Forward Process Formula:</text>
  <text x="130" y="355" font-family="Times New Roman, serif" font-size="26" fill="#000000">
    q(y‚Çú | t, y) = Œ† q(y‚Çú‚Å± | t, y‚Å±)    where    q(y‚Çú‚Å± | t, y‚Å±) = { 1-t if y‚Çú‚Å± = y‚Å±,  t if y‚Çú‚Å± = [MASK],  0 otherwise }
  </text>
  
  <!-- Visual explanation -->
  <text x="90" y="420" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#000000">Visualization: Token masking over time t ‚àà [0, 1]</text>
  
  <!-- t = 0 (clean) -->
  <text x="90" y="480" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#000000">t = 0 (clean):</text>
  <rect x="200" y="455" width="80" height="45" rx="5" fill="#4caf50"/>
  <text x="240" y="485" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white" text-anchor="middle">The</text>
  <rect x="290" y="455" width="80" height="45" rx="5" fill="#4caf50"/>
  <text x="330" y="485" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white" text-anchor="middle">cat</text>
  <rect x="380" y="455" width="80" height="45" rx="5" fill="#4caf50"/>
  <text x="420" y="485" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white" text-anchor="middle">sat</text>
  <rect x="470" y="455" width="80" height="45" rx="5" fill="#4caf50"/>
  <text x="510" y="485" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white" text-anchor="middle">on</text>
  <rect x="560" y="455" width="80" height="45" rx="5" fill="#4caf50"/>
  <text x="600" y="485" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white" text-anchor="middle">the</text>
  <rect x="650" y="455" width="80" height="45" rx="5" fill="#4caf50"/>
  <text x="690" y="485" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white" text-anchor="middle">mat</text>
  <text x="760" y="485" font-family="Arial, sans-serif" font-size="18" fill="#2e7d32">‚Üê All tokens visible (0% masked)</text>
  
  <!-- t = 0.3 -->
  <text x="90" y="550" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#000000">t = 0.3:</text>
  <rect x="200" y="525" width="80" height="45" rx="5" fill="#4caf50"/>
  <text x="240" y="555" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white" text-anchor="middle">The</text>
  <rect x="290" y="525" width="80" height="45" rx="5" fill="#9e9e9e"/>
  <text x="330" y="555" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white" text-anchor="middle">[M]</text>
  <rect x="380" y="525" width="80" height="45" rx="5" fill="#4caf50"/>
  <text x="420" y="555" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white" text-anchor="middle">sat</text>
  <rect x="470" y="525" width="80" height="45" rx="5" fill="#4caf50"/>
  <text x="510" y="555" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white" text-anchor="middle">on</text>
  <rect x="560" y="525" width="80" height="45" rx="5" fill="#9e9e9e"/>
  <text x="600" y="555" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white" text-anchor="middle">[M]</text>
  <rect x="650" y="525" width="80" height="45" rx="5" fill="#4caf50"/>
  <text x="690" y="555" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white" text-anchor="middle">mat</text>
  <text x="760" y="555" font-family="Arial, sans-serif" font-size="18" fill="#ff9800">‚Üê ~30% tokens masked</text>
  
  <!-- t = 1.0 (fully masked) -->
  <text x="90" y="620" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#000000">t = 1.0 (noisy):</text>
  <rect x="200" y="595" width="80" height="45" rx="5" fill="#9e9e9e"/>
  <text x="240" y="625" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white" text-anchor="middle">[M]</text>
  <rect x="290" y="595" width="80" height="45" rx="5" fill="#9e9e9e"/>
  <text x="330" y="625" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white" text-anchor="middle">[M]</text>
  <rect x="380" y="595" width="80" height="45" rx="5" fill="#9e9e9e"/>
  <text x="420" y="625" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white" text-anchor="middle">[M]</text>
  <rect x="470" y="595" width="80" height="45" rx="5" fill="#9e9e9e"/>
  <text x="510" y="625" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white" text-anchor="middle">[M]</text>
  <rect x="560" y="595" width="80" height="45" rx="5" fill="#9e9e9e"/>
  <text x="600" y="625" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white" text-anchor="middle">[M]</text>
  <rect x="650" y="595" width="80" height="45" rx="5" fill="#9e9e9e"/>
  <text x="690" y="625" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white" text-anchor="middle">[M]</text>
  <text x="760" y="625" font-family="Arial, sans-serif" font-size="18" fill="#c62828">‚Üê 100% tokens masked</text>
  
  <!-- Reverse Process Section -->
  <rect x="50" y="670" width="2100" height="550" rx="12" fill="#e3f2fd" stroke="#1976d2" stroke-width="3" filter="url(#shadowDiff)"/>
  <text x="90" y="730" font-family="Arial, sans-serif" font-size="32" font-weight="bold" fill="#000000">
    üì§ Reverse Process: Denoising (Unmasking) - Generation
  </text>
  
  <!-- Reverse formula -->
  <rect x="90" y="760" width="2020" height="80" rx="10" fill="#bbdefb" stroke="#1565c0" stroke-width="2"/>
  <text x="130" y="800" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#000000">Model Objective:</text>
  <text x="500" y="800" font-family="Times New Roman, serif" font-size="26" fill="#000000">
    pŒ∏(y‚Å∞ | y‚Çú) = Œ† pŒ∏(y‚Å∞‚Å± | y‚Çú)    ‚Üí    Predict original tokens from masked sequence
  </text>
  
  <!-- Generation steps -->
  <text x="90" y="890" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#000000">Generation Process (t: 1 ‚Üí 0):</text>
  
  <!-- Step 1 -->
  <rect x="90" y="920" width="380" height="120" rx="10" fill="#e3f2fd" stroke="#1976d2" stroke-width="2"/>
  <text x="280" y="960" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#000000" text-anchor="middle">Step 1: t = 1.0</text>
  <rect x="110" y="985" width="50" height="35" rx="5" fill="#9e9e9e"/>
  <text x="135" y="1008" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">[M]</text>
  <rect x="170" y="985" width="50" height="35" rx="5" fill="#9e9e9e"/>
  <text x="195" y="1008" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">[M]</text>
  <rect x="230" y="985" width="50" height="35" rx="5" fill="#9e9e9e"/>
  <text x="255" y="1008" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">[M]</text>
  <rect x="290" y="985" width="50" height="35" rx="5" fill="#9e9e9e"/>
  <text x="315" y="1008" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">[M]</text>
  <rect x="350" y="985" width="50" height="35" rx="5" fill="#9e9e9e"/>
  <text x="375" y="1008" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">[M]</text>
  <rect x="410" y="985" width="50" height="35" rx="5" fill="#9e9e9e"/>
  <text x="435" y="1008" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">[M]</text>
  
  <!-- Arrow -->
  <line x1="470" y1="980" x2="520" y2="980" stroke="#1976d2" stroke-width="3" marker-end="url(#arrowDiff)"/>
  <text x="495" y="1000" font-family="Arial, sans-serif" font-size="14" fill="#1976d2" text-anchor="middle">predict</text>
  
  <!-- Step 2 -->
  <rect x="530" y="920" width="380" height="120" rx="10" fill="#e3f2fd" stroke="#1976d2" stroke-width="2"/>
  <text x="720" y="960" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#000000" text-anchor="middle">Step 2: t = 0.7</text>
  <rect x="550" y="985" width="50" height="35" rx="5" fill="#4caf50"/>
  <text x="575" y="1008" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">The</text>
  <rect x="610" y="985" width="50" height="35" rx="5" fill="#9e9e9e"/>
  <text x="635" y="1008" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">[M]</text>
  <rect x="670" y="985" width="50" height="35" rx="5" fill="#4caf50"/>
  <text x="695" y="1008" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">sat</text>
  <rect x="730" y="985" width="50" height="35" rx="5" fill="#9e9e9e"/>
  <text x="755" y="1008" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">[M]</text>
  <rect x="790" y="985" width="50" height="35" rx="5" fill="#9e9e9e"/>
  <text x="815" y="1008" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">[M]</text>
  <rect x="850" y="985" width="50" height="35" rx="5" fill="#9e9e9e"/>
  <text x="875" y="1008" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">[M]</text>
  
  <!-- Arrow -->
  <line x1="910" y1="980" x2="960" y2="980" stroke="#1976d2" stroke-width="3" marker-end="url(#arrowDiff)"/>
  
  <!-- Step 3 -->
  <rect x="970" y="920" width="380" height="120" rx="10" fill="#e3f2fd" stroke="#1976d2" stroke-width="2"/>
  <text x="1160" y="960" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#000000" text-anchor="middle">Step 3: t = 0.4</text>
  <rect x="990" y="985" width="50" height="35" rx="5" fill="#4caf50"/>
  <text x="1015" y="1008" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">The</text>
  <rect x="1050" y="985" width="50" height="35" rx="5" fill="#4caf50"/>
  <text x="1075" y="1008" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">cat</text>
  <rect x="1110" y="985" width="50" height="35" rx="5" fill="#4caf50"/>
  <text x="1135" y="1008" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">sat</text>
  <rect x="1170" y="985" width="50" height="35" rx="5" fill="#9e9e9e"/>
  <text x="1195" y="1008" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">[M]</text>
  <rect x="1230" y="985" width="50" height="35" rx="5" fill="#4caf50"/>
  <text x="1255" y="1008" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">the</text>
  <rect x="1290" y="985" width="50" height="35" rx="5" fill="#9e9e9e"/>
  <text x="1315" y="1008" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">[M]</text>
  
  <!-- Arrow -->
  <line x1="1350" y1="980" x2="1400" y2="980" stroke="#1976d2" stroke-width="3" marker-end="url(#arrowDiff)"/>
  
  <!-- Step 4 (final) -->
  <rect x="1410" y="920" width="380" height="120" rx="10" fill="#c8e6c9" stroke="#2e7d32" stroke-width="2"/>
  <text x="1600" y="960" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#000000" text-anchor="middle">Final: t = 0.0</text>
  <rect x="1430" y="985" width="50" height="35" rx="5" fill="#4caf50"/>
  <text x="1455" y="1008" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">The</text>
  <rect x="1490" y="985" width="50" height="35" rx="5" fill="#4caf50"/>
  <text x="1515" y="1008" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">cat</text>
  <rect x="1550" y="985" width="50" height="35" rx="5" fill="#4caf50"/>
  <text x="1575" y="1008" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">sat</text>
  <rect x="1610" y="985" width="50" height="35" rx="5" fill="#4caf50"/>
  <text x="1635" y="1008" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">on</text>
  <rect x="1670" y="985" width="50" height="35" rx="5" fill="#4caf50"/>
  <text x="1695" y="1008" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">the</text>
  <rect x="1730" y="985" width="50" height="35" rx="5" fill="#4caf50"/>
  <text x="1755" y="1008" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">mat</text>
  
  <!-- Key insight -->
  <rect x="90" y="1070" width="2020" height="120" rx="10" fill="#e8f5e9" stroke="#4caf50" stroke-width="2"/>
  <text x="130" y="1115" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#000000">üîë Key Difference from Autoregressive:</text>
  <text x="130" y="1160" font-family="Arial, sans-serif" font-size="22" fill="#000000">
    Diffusion predicts ALL masked tokens in PARALLEL at each step, not left-to-right sequentially!
  </text>
  
  <!-- Training Objective Section -->
  <rect x="50" y="1260" width="2100" height="400" rx="12" fill="#fff3e0" stroke="#f57c00" stroke-width="3" filter="url(#shadowDiff)"/>
  <text x="90" y="1320" font-family="Arial, sans-serif" font-size="32" font-weight="bold" fill="#000000">
    üìä Training Objective: ELBO (Evidence Lower Bound)
  </text>
  
  <!-- Main loss formula -->
  <rect x="90" y="1350" width="2020" height="120" rx="10" fill="#ffe0b2" stroke="#ef6c00" stroke-width="2"/>
  <text x="130" y="1395" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#000000">Negative Log-Likelihood Upper Bound:</text>
  <text x="130" y="1450" font-family="Times New Roman, serif" font-size="28" fill="#000000">
    L(Œ∏) = E_{y,t,y‚Çú} [ w(t) ¬∑ Œ£·µ¢ ùüô[y‚Çú‚Å± = MASK] ¬∑ (-log pŒ∏(y‚Å± | y‚Çú)) ]
  </text>
  
  <!-- Explanation -->
  <rect x="90" y="1490" width="1000" height="140" rx="10" fill="#ffecb3" stroke="#ff8f00" stroke-width="2"/>
  <text x="130" y="1535" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#000000">Loss Components:</text>
  <text x="130" y="1575" font-family="Arial, sans-serif" font-size="20" fill="#000000">‚Ä¢ w(t) = weighting function (e.g., 1/t)</text>
  <text x="130" y="1610" font-family="Arial, sans-serif" font-size="20" fill="#000000">‚Ä¢ Only compute loss on MASKED positions</text>
  
  <rect x="1110" y="1490" width="1000" height="140" rx="10" fill="#ffecb3" stroke="#ff8f00" stroke-width="2"/>
  <text x="1150" y="1535" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#000000">Training Process:</text>
  <text x="1150" y="1575" font-family="Arial, sans-serif" font-size="20" fill="#000000">‚Ä¢ Sample t ~ U[0,1] uniformly</text>
  <text x="1150" y="1610" font-family="Arial, sans-serif" font-size="20" fill="#000000">‚Ä¢ Mask tokens with probability t</text>
  
  <!-- SFT Section -->
  <rect x="50" y="1700" width="2100" height="280" rx="12" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="3" filter="url(#shadowDiff)"/>
  <text x="90" y="1760" font-family="Arial, sans-serif" font-size="32" font-weight="bold" fill="#000000">
    üéØ Supervised Fine-Tuning (SFT) for Instruction Following
  </text>
  
  <rect x="90" y="1790" width="2020" height="80" rx="10" fill="#e1bee7" stroke="#9c27b0" stroke-width="2"/>
  <text x="130" y="1835" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#000000">SFT Loss (Response-Only Masking):</text>
  <text x="700" y="1835" font-family="Times New Roman, serif" font-size="26" fill="#000000">
    L_SFT = E [ -log pŒ∏(response | masked_response, prompt) ]
  </text>
  
  <text x="90" y="1920" font-family="Arial, sans-serif" font-size="22" fill="#000000">
    ‚Ä¢ Only mask and predict the RESPONSE tokens (answer part)
  </text>
  <text x="90" y="1960" font-family="Arial, sans-serif" font-size="22" fill="#000000">
    ‚Ä¢ PROMPT tokens (question) remain visible as conditioning context
  </text>
  
  <!-- Footer Summary -->
  <rect x="50" y="2020" width="2100" height="340" rx="12" fill="#37474f" filter="url(#shadowDiff)"/>
  <text x="1100" y="2080" font-family="Arial, sans-serif" font-size="32" font-weight="bold" fill="white" text-anchor="middle">
    Summary: Masked Diffusion vs Autoregressive
  </text>
  
  <rect x="100" y="2110" width="950" height="220" rx="10" fill="#455a64"/>
  <text x="575" y="2155" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#81d4fa" text-anchor="middle">Autoregressive (GPT-style)</text>
  <text x="140" y="2200" font-family="Arial, sans-serif" font-size="20" fill="white">‚Ä¢ Generate left-to-right, one token at a time</text>
  <text x="140" y="2240" font-family="Arial, sans-serif" font-size="20" fill="white">‚Ä¢ L tokens = L sequential forward passes</text>
  <text x="140" y="2280" font-family="Arial, sans-serif" font-size="20" fill="white">‚Ä¢ Causal attention mask</text>
  <text x="140" y="2320" font-family="Arial, sans-serif" font-size="20" fill="white">‚Ä¢ Easy to sample, hard to control</text>
  
  <rect x="1100" y="2110" width="1000" height="220" rx="10" fill="#455a64"/>
  <text x="1600" y="2155" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#a5d6a7" text-anchor="middle">Masked Diffusion (LLaDA-style)</text>
  <text x="1140" y="2200" font-family="Arial, sans-serif" font-size="20" fill="white">‚Ä¢ Iteratively unmask, parallel within each step</text>
  <text x="1140" y="2240" font-family="Arial, sans-serif" font-size="20" fill="white">‚Ä¢ T denoising steps (T << L typically)</text>
  <text x="1140" y="2280" font-family="Arial, sans-serif" font-size="20" fill="white">‚Ä¢ Full bidirectional attention</text>
  <text x="1140" y="2320" font-family="Arial, sans-serif" font-size="20" fill="white">‚Ä¢ More controllable, parallel generation</text>
</svg>



<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 950 800">
  <defs>
    <linearGradient id="bgGradS1" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0f0f23"/>
      <stop offset="100%" style="stop-color:#1a1a3e"/>
    </linearGradient>
  </defs>
  
  <!-- Background -->
  <rect width="950" height="800" fill="url(#bgGradS1)"/>
  
  <!-- Title -->
  <text x="475" y="40" fill="#fff" font-size="26" font-weight="bold" text-anchor="middle" font-family="system-ui">Step 1: Understanding the Problem</text>
  <text x="475" y="70" fill="#667eea" font-size="16" text-anchor="middle" font-family="system-ui">Why do diffusion language models need a new approach?</text>
  
  <!-- Section 1: What is Autoregressive (AR) LM -->
  <g transform="translate(40, 100)">
    <rect x="0" y="0" width="420" height="280" rx="12" fill="#1a1a3e" stroke="#ff6b6b" stroke-width="2"/>
    <text x="210" y="30" fill="#ff6b6b" font-size="16" font-weight="bold" text-anchor="middle" font-family="system-ui">Autoregressive LM (GPT, LLaMA, etc.)</text>
    
    <g transform="translate(20, 55)">
      <text x="0" y="0" fill="#fff" font-size="12" font-weight="bold" font-family="system-ui">Generation Process:</text>
      <text x="0" y="25" fill="#aaa" font-size="11" font-family="system-ui">Generate one token at a time, left-to-right</text>
      
      <!-- Visual example -->
      <g transform="translate(0, 45)">
        <text x="0" y="0" fill="#aaa" font-size="10" font-family="system-ui">Example: "What is 2+2?" → Generate answer</text>
        
        <!-- Step by step generation -->
        <g transform="translate(0, 20)">
          <text x="0" y="0" fill="#888" font-size="9" font-family="system-ui">Step 1:</text>
          <rect x="50" y="-12" width="30" height="18" rx="3" fill="#38ef7d" opacity="0.6"/>
          <rect x="82" y="-12" width="30" height="18" rx="3" fill="#ff6b6b" opacity="0.8"/>
          <text x="65" y="2" fill="#000" font-size="8" text-anchor="middle" font-family="system-ui">...</text>
          <text x="97" y="2" fill="#fff" font-size="8" text-anchor="middle" font-weight="bold" font-family="system-ui">The</text>
          
          <text x="0" y="25" fill="#888" font-size="9" font-family="system-ui">Step 2:</text>
          <rect x="50" y="13" width="30" height="18" rx="3" fill="#38ef7d" opacity="0.6"/>
          <rect x="82" y="13" width="30" height="18" rx="3" fill="#38ef7d" opacity="0.6"/>
          <rect x="114" y="13" width="40" height="18" rx="3" fill="#ff6b6b" opacity="0.8"/>
          <text x="65" y="27" fill="#000" font-size="8" text-anchor="middle" font-family="system-ui">...</text>
          <text x="97" y="27" fill="#000" font-size="8" text-anchor="middle" font-family="system-ui">The</text>
          <text x="134" y="27" fill="#fff" font-size="8" text-anchor="middle" font-weight="bold" font-family="system-ui">answer</text>
          
          <text x="0" y="50" fill="#888" font-size="9" font-family="system-ui">Step 3:</text>
          <rect x="50" y="38" width="30" height="18" rx="3" fill="#38ef7d" opacity="0.6"/>
          <rect x="82" y="38" width="30" height="18" rx="3" fill="#38ef7d" opacity="0.6"/>
          <rect x="114" y="38" width="40" height="18" rx="3" fill="#38ef7d" opacity="0.6"/>
          <rect x="156" y="38" width="25" height="18" rx="3" fill="#ff6b6b" opacity="0.8"/>
          <text x="65" y="52" fill="#000" font-size="8" text-anchor="middle" font-family="system-ui">...</text>
          <text x="97" y="52" fill="#000" font-size="8" text-anchor="middle" font-family="system-ui">The</text>
          <text x="134" y="52" fill="#000" font-size="8" text-anchor="middle" font-family="system-ui">answer</text>
          <text x="169" y="52" fill="#fff" font-size="8" text-anchor="middle" font-weight="bold" font-family="system-ui">is</text>
        </g>
      </g>
      
      <!-- Math formula -->
      <g transform="translate(0, 170)">
        <text x="0" y="0" fill="#fff" font-size="12" font-weight="bold" font-family="system-ui">Mathematical Definition:</text>
        <rect x="0" y="10" width="380" height="35" rx="5" fill="#2a2a4e"/>
        <text x="190" y="33" fill="#fff" font-size="13" text-anchor="middle" font-family="monospace">P(x) = ∏ P(x_t | x_1, x_2, ..., x_{t-1})</text>
      </g>
      
      <!-- Pros/Cons -->
      <g transform="translate(0, 220)">
        <text x="0" y="0" fill="#38ef7d" font-size="10" font-family="system-ui">✓ Simple, well-optimized (KV cache)</text>
        <text x="0" y="18" fill="#f5576c" font-size="10" font-family="system-ui">✗ Sequential: N tokens = N forward passes</text>
      </g>
    </g>
  </g>
  
  <!-- Section 2: What is Diffusion LM -->
  <g transform="translate(490, 100)">
    <rect x="0" y="0" width="420" height="280" rx="12" fill="#1a1a3e" stroke="#4ecdc4" stroke-width="2"/>
    <text x="210" y="30" fill="#4ecdc4" font-size="16" font-weight="bold" text-anchor="middle" font-family="system-ui">Diffusion LM (MDLM, SEDD, etc.)</text>
    
    <g transform="translate(20, 55)">
      <text x="0" y="0" fill="#fff" font-size="12" font-weight="bold" font-family="system-ui">Generation Process:</text>
      <text x="0" y="25" fill="#aaa" font-size="11" font-family="system-ui">Start with all [MASK], iteratively denoise</text>
      
      <!-- Visual example -->
      <g transform="translate(0, 45)">
        <text x="0" y="0" fill="#aaa" font-size="10" font-family="system-ui">Example: Predict answer positions</text>
        
        <!-- Diffusion steps -->
        <g transform="translate(0, 20)">
          <text x="0" y="0" fill="#888" font-size="9" font-family="system-ui">t=T:</text>
          <rect x="40" y="-12" width="25" height="18" rx="3" fill="#f5576c" opacity="0.8"/>
          <rect x="67" y="-12" width="25" height="18" rx="3" fill="#f5576c" opacity="0.8"/>
          <rect x="94" y="-12" width="25" height="18" rx="3" fill="#f5576c" opacity="0.8"/>
          <rect x="121" y="-12" width="25" height="18" rx="3" fill="#f5576c" opacity="0.8"/>
          <text x="52" y="2" fill="#fff" font-size="7" text-anchor="middle" font-family="system-ui">[M]</text>
          <text x="79" y="2" fill="#fff" font-size="7" text-anchor="middle" font-family="system-ui">[M]</text>
          <text x="106" y="2" fill="#fff" font-size="7" text-anchor="middle" font-family="system-ui">[M]</text>
          <text x="133" y="2" fill="#fff" font-size="7" text-anchor="middle" font-family="system-ui">[M]</text>
          <text x="160" y="0" fill="#aaa" font-size="9" font-family="system-ui">← All masked</text>
          
          <text x="0" y="25" fill="#888" font-size="9" font-family="system-ui">t=T/2:</text>
          <rect x="40" y="13" width="25" height="18" rx="3" fill="#4ecdc4" opacity="0.7"/>
          <rect x="67" y="13" width="25" height="18" rx="3" fill="#f5576c" opacity="0.6"/>
          <rect x="94" y="13" width="25" height="18" rx="3" fill="#4ecdc4" opacity="0.7"/>
          <rect x="121" y="13" width="25" height="18" rx="3" fill="#f5576c" opacity="0.6"/>
          <text x="52" y="27" fill="#000" font-size="7" text-anchor="middle" font-family="system-ui">The</text>
          <text x="79" y="27" fill="#fff" font-size="7" text-anchor="middle" font-family="system-ui">[M]</text>
          <text x="106" y="27" fill="#000" font-size="7" text-anchor="middle" font-family="system-ui">is</text>
          <text x="133" y="27" fill="#fff" font-size="7" text-anchor="middle" font-family="system-ui">[M]</text>
          
          <text x="0" y="50" fill="#888" font-size="9" font-family="system-ui">t=0:</text>
          <rect x="40" y="38" width="25" height="18" rx="3" fill="#4ecdc4" opacity="0.9"/>
          <rect x="67" y="38" width="35" height="18" rx="3" fill="#4ecdc4" opacity="0.9"/>
          <rect x="104" y="38" width="25" height="18" rx="3" fill="#4ecdc4" opacity="0.9"/>
          <rect x="131" y="38" width="25" height="18" rx="3" fill="#4ecdc4" opacity="0.9"/>
          <text x="52" y="52" fill="#000" font-size="7" text-anchor="middle" font-family="system-ui">The</text>
          <text x="84" y="52" fill="#000" font-size="7" text-anchor="middle" font-family="system-ui">answer</text>
          <text x="116" y="52" fill="#000" font-size="7" text-anchor="middle" font-family="system-ui">is</text>
          <text x="143" y="52" fill="#000" font-size="7" text-anchor="middle" font-family="system-ui">4</text>
          <text x="170" y="50" fill="#aaa" font-size="9" font-family="system-ui">← Complete</text>
        </g>
      </g>
      
      <!-- Math formula -->
      <g transform="translate(0, 170)">
        <text x="0" y="0" fill="#fff" font-size="12" font-weight="bold" font-family="system-ui">Mathematical Definition:</text>
        <rect x="0" y="10" width="380" height="35" rx="5" fill="#2a2a4e"/>
        <text x="190" y="33" fill="#fff" font-size="13" text-anchor="middle" font-family="monospace">P(x_0|x_T) = ∏ P(x_{t-1}|x_t)</text>
      </g>
      
      <!-- Pros/Cons -->
      <g transform="translate(0, 220)">
        <text x="0" y="0" fill="#38ef7d" font-size="10" font-family="system-ui">✓ Parallel: predict all positions at once</text>
        <text x="0" y="18" fill="#f5576c" font-size="10" font-family="system-ui">✗ Needs bidirectional attention → no KV cache</text>
      </g>
    </g>
  </g>
  
  <!-- Section 3: The Core Problem -->
  <g transform="translate(40, 400)">
    <rect x="0" y="0" width="870" height="180" rx="12" fill="#1a1a3e" stroke="#f5576c" stroke-width="2"/>
    <text x="435" y="30" fill="#f5576c" font-size="16" font-weight="bold" text-anchor="middle" font-family="system-ui">❌ The Core Problem: Attention Pattern Mismatch</text>
    
    <g transform="translate(30, 55)">
      <!-- Bidirectional requires -->
      <rect x="0" y="0" width="390" height="105" rx="8" fill="#2a2a4e"/>
      <text x="195" y="22" fill="#4ecdc4" font-size="12" font-weight="bold" text-anchor="middle" font-family="system-ui">Standard Diffusion LM</text>
      <text x="20" y="45" fill="#aaa" font-size="10" font-family="system-ui">Requires: Each position sees ALL other positions</text>
      <text x="20" y="65" fill="#aaa" font-size="10" font-family="system-ui">Why? Token at position i depends on context at position j &gt; i</text>
      <text x="20" y="90" fill="#f5576c" font-size="10" font-family="system-ui">Result: Must recompute K,V for entire sequence every step</text>
      
      <!-- No KV cache -->
      <rect x="420" y="0" width="390" height="105" rx="8" fill="#2a2a4e"/>
      <text x="615" y="22" fill="#f5576c" font-size="12" font-weight="bold" text-anchor="middle" font-family="system-ui">Why This Matters</text>
      <text x="440" y="45" fill="#aaa" font-size="10" font-family="system-ui">Without KV Cache:</text>
      <text x="440" y="65" fill="#aaa" font-size="10" font-family="system-ui">• Computation: O(N² × T) vs O(N × T) for AR</text>
      <text x="440" y="85" fill="#aaa" font-size="10" font-family="system-ui">• Memory: Recompute all attention every step</text>
      <text x="440" y="105" fill="#f5576c" font-size="10" font-family="system-ui">→ Parallel tokens don't translate to real speedup!</text>
    </g>
  </g>
  
  <!-- Section 4: What WeDLM Solves -->
  <g transform="translate(40, 600)">
    <rect x="0" y="0" width="870" height="180" rx="12" fill="#1a1a3e" stroke="#38ef7d" stroke-width="2"/>
    <text x="435" y="30" fill="#38ef7d" font-size="16" font-weight="bold" text-anchor="middle" font-family="system-ui">✓ WeDLM Solution: Keep Causal Attention + Enable Parallel Prediction</text>
    
    <g transform="translate(30, 55)">
      <text x="0" y="0" fill="#fff" font-size="12" font-weight="bold" font-family="system-ui">Key Insight:</text>
      <rect x="0" y="15" width="810" height="45" rx="6" fill="#2a2a4e" stroke="#38ef7d" stroke-width="1"/>
      <text x="405" y="35" fill="#fff" font-size="11" text-anchor="middle" font-family="system-ui">If masks only need to see the prefix (committed tokens), they don't need to see each other!</text>
      <text x="405" y="52" fill="#38ef7d" font-size="11" text-anchor="middle" font-family="system-ui">→ Rearrange sequence so masks come AFTER non-masks → Standard causal attention works!</text>
      
      <g transform="translate(0, 75)">
        <rect x="0" y="0" width="260" height="40" rx="5" fill="#2a2a4e"/>
        <text x="130" y="15" fill="#38ef7d" font-size="10" text-anchor="middle" font-weight="bold" font-family="system-ui">✓ KV Cache Compatible</text>
        <text x="130" y="32" fill="#aaa" font-size="9" text-anchor="middle" font-family="system-ui">Prefix K,V cached and reused</text>
        
        <rect x="280" y="0" width="260" height="40" rx="5" fill="#2a2a4e"/>
        <text x="410" y="15" fill="#38ef7d" font-size="10" text-anchor="middle" font-weight="bold" font-family="system-ui">✓ Parallel Token Prediction</text>
        <text x="410" y="32" fill="#aaa" font-size="9" text-anchor="middle" font-family="system-ui">Multiple masks filled per step</text>
        
        <rect x="560" y="0" width="250" height="40" rx="5" fill="#2a2a4e"/>
        <text x="685" y="15" fill="#38ef7d" font-size="10" text-anchor="middle" font-weight="bold" font-family="system-ui">✓ Use Existing AR Models</text>
        <text x="685" y="32" fill="#aaa" font-size="9" text-anchor="middle" font-family="system-ui">Initialize from Qwen, LLaMA, etc.</text>
      </g>
    </g>
  </g>
</svg>


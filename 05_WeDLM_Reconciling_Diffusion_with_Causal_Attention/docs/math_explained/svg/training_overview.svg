<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 950 500">
  <defs>
    <linearGradient id="bgGradTrain" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0f0f23"/>
      <stop offset="100%" style="stop-color:#1a1a3e"/>
    </linearGradient>
    <marker id="arrowTrain" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#667eea"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="950" height="500" fill="url(#bgGradTrain)"/>
  
  <!-- Title -->
  <text x="475" y="40" fill="#fff" font-size="24" font-weight="bold" text-anchor="middle" font-family="system-ui">Training Pipeline</text>
  <text x="475" y="68" fill="#aaa" font-size="14" text-anchor="middle" font-family="system-ui">Initialize from pretrained AR model ‚Üí Fine-tune with mask prediction</text>
  
  <!-- Step 1: Pretrained AR Model -->
  <g transform="translate(80, 110)">
    <rect x="0" y="0" width="200" height="140" rx="12" fill="#1a1a3e" stroke="#f7b731" stroke-width="2"/>
    <text x="100" y="30" fill="#f7b731" font-size="14" font-weight="bold" text-anchor="middle" font-family="system-ui">Step 1</text>
    <text x="100" y="55" fill="#fff" font-size="12" text-anchor="middle" font-family="system-ui">Pretrained AR Model</text>
    
    <!-- Model icon -->
    <rect x="60" y="70" width="80" height="50" rx="6" fill="#2a2a4e" stroke="#f7b731" stroke-width="1"/>
    <text x="100" y="92" fill="#f7b731" font-size="10" text-anchor="middle" font-family="system-ui">Qwen3-8B</text>
    <text x="100" y="108" fill="#aaa" font-size="9" text-anchor="middle" font-family="system-ui">Causal Attn</text>
  </g>
  
  <!-- Arrow 1 -->
  <path d="M290,180 L340,180" stroke="#667eea" stroke-width="2" marker-end="url(#arrowTrain)"/>
  <text x="315" y="170" fill="#667eea" font-size="10" text-anchor="middle" font-family="system-ui">copy</text>
  <text x="315" y="195" fill="#aaa" font-size="9" text-anchor="middle" font-family="system-ui">weights</text>
  
  <!-- Step 2: Add Mask Token -->
  <g transform="translate(350, 110)">
    <rect x="0" y="0" width="200" height="140" rx="12" fill="#1a1a3e" stroke="#667eea" stroke-width="2"/>
    <text x="100" y="30" fill="#667eea" font-size="14" font-weight="bold" text-anchor="middle" font-family="system-ui">Step 2</text>
    <text x="100" y="55" fill="#fff" font-size="12" text-anchor="middle" font-family="system-ui">Add Mask Token</text>
    
    <!-- Token visualization -->
    <g transform="translate(20, 70)">
      <rect x="0" y="0" width="30" height="20" rx="3" fill="#38ef7d" opacity="0.6"/>
      <rect x="35" y="0" width="30" height="20" rx="3" fill="#38ef7d" opacity="0.6"/>
      <rect x="70" y="0" width="30" height="20" rx="3" fill="#38ef7d" opacity="0.6"/>
      <text x="15" y="14" fill="#000" font-size="8" text-anchor="middle" font-family="system-ui">...</text>
      <text x="50" y="14" fill="#000" font-size="8" text-anchor="middle" font-family="system-ui">tok</text>
      <text x="85" y="14" fill="#000" font-size="8" text-anchor="middle" font-family="system-ui">tok</text>
      
      <rect x="110" y="0" width="50" height="20" rx="3" fill="#f5576c" opacity="0.8" stroke="#fff" stroke-width="1"/>
      <text x="135" y="14" fill="#fff" font-size="8" text-anchor="middle" font-weight="bold" font-family="system-ui">[MASK]</text>
    </g>
    
    <text x="100" y="110" fill="#aaa" font-size="9" text-anchor="middle" font-family="system-ui">Extend vocabulary</text>
    <text x="100" y="125" fill="#aaa" font-size="9" text-anchor="middle" font-family="system-ui">with mask token</text>
  </g>
  
  <!-- Arrow 2 -->
  <path d="M560,180 L610,180" stroke="#667eea" stroke-width="2" marker-end="url(#arrowTrain)"/>
  <text x="585" y="170" fill="#667eea" font-size="10" text-anchor="middle" font-family="system-ui">train</text>
  
  <!-- Step 3: Fine-tune -->
  <g transform="translate(620, 110)">
    <rect x="0" y="0" width="250" height="140" rx="12" fill="#1a1a3e" stroke="#38ef7d" stroke-width="2"/>
    <text x="125" y="30" fill="#38ef7d" font-size="14" font-weight="bold" text-anchor="middle" font-family="system-ui">Step 3</text>
    <text x="125" y="55" fill="#fff" font-size="12" text-anchor="middle" font-family="system-ui">Fine-tune on Mask Prediction</text>
    
    <!-- Training objective -->
    <rect x="20" y="70" width="210" height="55" rx="6" fill="#2a2a4e"/>
    <text x="125" y="90" fill="#fff" font-size="10" text-anchor="middle" font-family="monospace">L = -Œ£ log p(x_i | x_C, x_M^&lt;i)</text>
    <text x="125" y="110" fill="#aaa" font-size="9" text-anchor="middle" font-family="system-ui">Predict masked positions given prefix</text>
  </g>
  
  <!-- Training Details Section -->
  <g transform="translate(80, 280)">
    <rect x="0" y="0" width="790" height="190" rx="12" fill="#1a1a3e" stroke="#667eea" stroke-width="2"/>
    <text x="395" y="30" fill="#fff" font-size="14" font-weight="bold" text-anchor="middle" font-family="system-ui">Training Details</text>
    
    <g transform="translate(30, 55)">
      <!-- Training data -->
      <rect x="0" y="0" width="230" height="115" rx="8" fill="#2a2a4e"/>
      <text x="115" y="22" fill="#667eea" font-size="11" font-weight="bold" text-anchor="middle" font-family="system-ui">üìö Training Data</text>
      <text x="20" y="45" fill="#aaa" font-size="10" font-family="system-ui">‚Ä¢ Same data as base model</text>
      <text x="20" y="62" fill="#aaa" font-size="10" font-family="system-ui">‚Ä¢ Random mask ratio: 10-50%</text>
      <text x="20" y="79" fill="#aaa" font-size="10" font-family="system-ui">‚Ä¢ Variable sequence lengths</text>
      <text x="20" y="96" fill="#aaa" font-size="10" font-family="system-ui">‚Ä¢ ~200B tokens total</text>
      
      <!-- Training config -->
      <rect x="250" y="0" width="230" height="115" rx="8" fill="#2a2a4e"/>
      <text x="365" y="22" fill="#38ef7d" font-size="11" font-weight="bold" text-anchor="middle" font-family="system-ui">‚öôÔ∏è Configuration</text>
      <text x="270" y="45" fill="#aaa" font-size="10" font-family="system-ui">‚Ä¢ Learning rate: 5e-5</text>
      <text x="270" y="62" fill="#aaa" font-size="10" font-family="system-ui">‚Ä¢ Batch size: 4M tokens</text>
      <text x="270" y="79" fill="#aaa" font-size="10" font-family="system-ui">‚Ä¢ Context length: 32K</text>
      <text x="270" y="96" fill="#aaa" font-size="10" font-family="system-ui">‚Ä¢ Hardware: 64√óH100</text>
      
      <!-- Key insight -->
      <rect x="500" y="0" width="230" height="115" rx="8" fill="#2a2a4e" stroke="#38ef7d" stroke-width="1"/>
      <text x="615" y="22" fill="#38ef7d" font-size="11" font-weight="bold" text-anchor="middle" font-family="system-ui">üí° Key Insight</text>
      <text x="520" y="45" fill="#aaa" font-size="10" font-family="system-ui">Causal attention during</text>
      <text x="520" y="62" fill="#aaa" font-size="10" font-family="system-ui">training means:</text>
      <text x="520" y="82" fill="#38ef7d" font-size="10" font-family="system-ui">‚úì Reuse AR weights</text>
      <text x="520" y="99" fill="#38ef7d" font-size="10" font-family="system-ui">‚úì Fast convergence</text>
    </g>
  </g>
</svg>

